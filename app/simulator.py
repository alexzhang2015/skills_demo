from typing import Optional

from .models import SystemOperation, SkillStatus


class SystemSimulator:
    """
    ç³»ç»Ÿæ¨¡æ‹Ÿå™¨ - æ¨¡æ‹Ÿåç«¯ç³»ç»Ÿæ“ä½œå’Œç”Ÿæˆæ‰§è¡Œç»“æœ
    """

    # æ¨¡æ‹Ÿçš„åç«¯ç³»ç»Ÿ
    SYSTEMS = {
        "POS": {"name": "POSç³»ç»Ÿ", "color": "#ef4444"},
        "APP": {"name": "Appåå°", "color": "#3b82f6"},
        "MENU_BOARD": {"name": "èœå•å±CMS", "color": "#22c55e"},
        "INVENTORY": {"name": "åº“å­˜ç³»ç»Ÿ", "color": "#f59e0b"},
        "PRICING": {"name": "å®šä»·å¼•æ“", "color": "#8b5cf6"},
        "CRM": {"name": "ä¼šå‘˜ç³»ç»Ÿ", "color": "#ec4899"},
        "MARKETING": {"name": "è¥é”€å¹³å°", "color": "#06b6d4"},
        "TRAINING": {"name": "åŸ¹è®­ç³»ç»Ÿ", "color": "#84cc16"},
    }

    # å„æŠ€èƒ½çš„ç³»ç»Ÿæ“ä½œæ˜ å°„
    SYSTEM_ACTIONS = {
        "menu-config": {
            0: [("APP", "è§£æèœå•å˜æ›´è¯·æ±‚")],
            1: [("INVENTORY", "éªŒè¯èœå“ä¿¡æ¯")],
            2: [("INVENTORY", "æ£€æŸ¥åŸæ–™åº“å­˜")],
            3: [("POS", "æ›´æ–°èœå•æ•°æ®åº“")],
            4: [("APP", "åŒæ­¥å•†å“ä¿¡æ¯")],
            5: [("MENU_BOARD", "æ¨é€å†…å®¹æ›´æ–°")],
            6: [("INVENTORY", "å…³è”SKU")],
            7: [("APP", "å‘é€å˜æ›´é€šçŸ¥")],
        },
        "price-adjust": {
            0: [("PRICING", "è§£æè°ƒä»·è¯·æ±‚")],
            1: [("PRICING", "è·å–ä»·æ ¼åŸºçº¿")],
            2: [("PRICING", "è®¡ç®—å˜åŠ¨å¹…åº¦")],
            3: [("PRICING", "è°ƒç”¨å®šä»·ç®—æ³•")],
            4: [("APP", "ç”Ÿæˆé¢„è§ˆæŠ¥å‘Š")],
            5: [("APP", "è§¦å‘å®¡æ‰¹æµç¨‹")],
            6: [("POS", "æ‰¹é‡æ›´æ–°ä»·æ ¼è¡¨")],
            7: [("APP", "åŒæ­¥Appä»·æ ¼")],
            8: [("MENU_BOARD", "æ›´æ–°ä»·æ ¼æ ‡ç­¾")],
            9: [("APP", "è®°å½•å˜æ›´æ—¥å¿—")],
        },
        "product-launch": {
            0: [("APP", "æ¥æ”¶ä¸Šå¸‚è¯·æ±‚")],
            1: [("APP", "æ£€æŸ¥èµ„æ–™å®Œæ•´æ€§")],
            2: [("INVENTORY", "åˆ›å»ºSKUå’ŒBOM")],
            3: [("POS", "é…ç½®æ–°å“æŒ‰é’®")],
            4: [("APP", "ä¸Šä¼ å•†å“è¯¦æƒ…")],
            5: [("MENU_BOARD", "å‡†å¤‡å®£ä¼ ç´ æ")],
            6: [("TRAINING", "è§¦å‘SOPåˆ¶ä½œ")],
            7: [("MARKETING", "åè°ƒæ¨å¹¿è®¡åˆ’")],
            8: [("CRM", "è®¾ç½®æ–°å“ä¼˜æƒ åˆ¸")],
            9: [("APP", "ç”Ÿæˆæ£€æŸ¥æ¸…å•")],
            10: [("APP", "å‘é€å°±ç»ªé€šçŸ¥")],
        },
        "campaign-setup": {
            0: [("MARKETING", "è§£ææ´»åŠ¨é…ç½®")],
            1: [("MARKETING", "éªŒè¯è§„åˆ™åˆæ³•æ€§")],
            2: [("MARKETING", "é…ç½®æ´»åŠ¨æ¨¡æ¿")],
            3: [("APP", "è®¾ç½®æ´»åŠ¨å…¥å£")],
            4: [("POS", "æ›´æ–°æŠ˜æ‰£è§„åˆ™")],
            5: [("CRM", "é…ç½®ç§¯åˆ†è§„åˆ™")],
            6: [("MARKETING", "ç”Ÿæˆé¢„æµ‹æŠ¥å‘Š")],
            7: [("MARKETING", "è®¾ç½®ç›‘æ§å‘Šè­¦")],
        },
        "store-audit": {
            0: [("POS", "è·å–è¿è¥æ•°æ®")],
            1: [("POS", "åˆ†æäº¤æ˜“å¼‚å¸¸")],
            2: [("INVENTORY", "æ£€æŸ¥ç›˜ç‚¹å·®å¼‚")],
            3: [("TRAINING", "å®¡æ ¸åŸ¹è®­å®Œæˆåº¦")],
            4: [("APP", "åˆ†æé¡¾å®¢è¯„ä»·")],
            5: [("APP", "ç”Ÿæˆè¯„åˆ†æŠ¥å‘Š")],
            6: [("APP", "åˆ›å»ºæ•´æ”¹æ¸…å•")],
            7: [("APP", "æ¨é€è‡³é—¨åº—App")],
        },
        "report-gen": {
            0: [("APP", "ç¡®å®šæŠ¥å‘Šç±»å‹")],
            1: [("POS", "æå–é”€å”®æ•°æ®")],
            2: [("APP", "è·å–çº¿ä¸Šè®¢å•")],
            3: [("CRM", "æ±‡æ€»æ¶ˆè´¹è¡Œä¸º")],
            4: [("INVENTORY", "åˆ†æåº“å­˜å‘¨è½¬")],
            5: [("APP", "è®¡ç®—KPIæŒ‡æ ‡")],
            6: [("APP", "ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨")],
            7: [("APP", "ç¼–å†™åˆ†ææ‘˜è¦")],
            8: [("APP", "è¾“å‡ºæŠ¥å‘Šæ–‡ä»¶")],
        },
    }

    # å„æŠ€èƒ½å„æ­¥éª¤çš„æ‰§è¡Œç»“æœ
    STEP_RESULTS = {
        "menu-config": [
            "å˜æ›´ç±»å‹: æ–°å¢èœå“ | èœå“: {item_name}",
            "éªŒè¯é€šè¿‡ | åç§°: {item_name} | ä»·æ ¼: Â¥22.00 | åˆ†ç±»: æ±‰å ¡",
            "åŸæ–™æ£€æŸ¥: é¸¡è…¿è‚‰(å……è¶³) | é¢åŒ…(å……è¶³) | é…±æ–™(å……è¶³)",
            "POSèœå•å·²æ›´æ–° | å½±å“é—¨åº—: 2,847å®¶ | æŒ‰é’®ä½ç½®: A3",
            "Appå•†å“å·²ä¸Šçº¿ | å•†å“ID: PRD-20241228-001",
            "èœå•å±å†…å®¹å·²æ¨é€ | æˆåŠŸç‡: 99.8% | å¤±è´¥é—¨åº—: 5å®¶",
            "SKUå…³è”å®Œæˆ | SKU: MCL-001 | BOMå·²é…ç½®",
            "é€šçŸ¥å·²å‘é€ | æ”¶ä»¶äºº: è¿è¥ç»„(12äºº) | åŒºåŸŸç»ç†(8äºº)",
        ],
        "price-adjust": [
            "è°ƒä»·è¯·æ±‚: {item_name} | åŒºåŸŸ: åä¸œ | è°ƒæ•´: +8%",
            "å½“å‰ä»·æ ¼: Â¥22.00 | å†å²æœ€é«˜: Â¥25.00 | å†å²æœ€ä½: Â¥18.00",
            "å½±å“é—¨åº—: 1,234å®¶ | é¢„è®¡æ”¶å…¥å˜åŒ–: +Â¥2.3M/æœˆ",
            "å®šä»·å¼•æ“å»ºè®®: Â¥23.80 (æœ€ä¼˜å¼¹æ€§ç‚¹)",
            "é¢„è§ˆæŠ¥å‘Šå·²ç”Ÿæˆ | åŒ…å«: ç«å“å¯¹æ¯”ã€å¼¹æ€§åˆ†æã€é£é™©è¯„ä¼°",
            "å®¡æ‰¹æµç¨‹å·²è§¦å‘ | å½“å‰èŠ‚ç‚¹: åŒºåŸŸæ€»ç›‘",
            "POSä»·æ ¼è¡¨å·²æ›´æ–° | ç”Ÿæ•ˆæ—¶é—´: æ˜æ—¥06:00",
            "Appä»·æ ¼å·²åŒæ­¥ | ç¼“å­˜å·²æ¸…ç†",
            "èœå•å±ä»·æ ¼å·²æ›´æ–° | æ¨é€å®Œæˆç‡: 100%",
            "å˜æ›´æ—¥å¿—å·²è®°å½• | å¯è¿½æº¯ID: CHG-20241228-089",
        ],
        "product-launch": [
            "ä¸Šå¸‚è¯·æ±‚: {item_name} | ä¸Šå¸‚æ—¥æœŸ: 2025-01-15 | åŒºåŸŸ: å…¨å›½",
            "èµ„æ–™å®Œæ•´æ€§: 100% | é…æ–¹âœ“ æˆæœ¬âœ“ å›¾ç‰‡âœ“ æ–‡æ¡ˆâœ“",
            "SKUåˆ›å»ºå®Œæˆ: MCL-NEW-001 | BOM: 12é¡¹åŸæ–™å·²é…ç½®",
            "POSæ–°å“æŒ‰é’®å·²é…ç½® | ä½ç½®: æ¨èä½C1 | ä»·æ ¼: Â¥25.00",
            "Appå•†å“é¡µå·²ä¸Šä¼  | åŒ…å«: è¯¦æƒ…ã€è¥å…»ä¿¡æ¯ã€æ¨èæ­é…",
            "èœå•å±ç´ æå·²å°±ç»ª | æ¨ªç‰ˆ/ç«–ç‰ˆ/è§†é¢‘å„1å¥—",
            "åŸ¹è®­ä»»åŠ¡å·²åˆ›å»º | SOPè§†é¢‘åˆ¶ä½œä¸­ | é¢„è®¡å®Œæˆ: 3å¤©",
            "è¥é”€è®¡åˆ’å·²å¯¹æ¥ | é¦–å‘¨ä¼˜æƒ : ç«‹å‡Â¥5 | é¢„ç®—: Â¥500K",
            "æ–°å“åˆ¸å·²é…ç½® | é¢é¢: Â¥5 | å‘æ”¾æ¸ é“: App/å°ç¨‹åº",
            "æ£€æŸ¥æ¸…å•: 15/18é¡¹å®Œæˆ | å¾…åŠ: ç‰©æ–™åˆ°ä½ã€åŸ¹è®­å®Œæˆã€æµ‹è¯•è®¢å•",
            "å°±ç»ªé€šçŸ¥å·²å‘é€ | å€’è®¡æ—¶: 18å¤©",
        ],
        "campaign-setup": [
            "æ´»åŠ¨é…ç½®: æ»¡30å‡5 | æ—¶é—´: 12.28-01.03 | æ¸ é“: å…¨æ¸ é“",
            "è§„åˆ™éªŒè¯é€šè¿‡ | æ— æ—¶é—´å†²çª | é¢„ç®—å……è¶³",
            "æ´»åŠ¨æ¨¡æ¿å·²åˆ›å»º | ID: CMP-20241228-001",
            "Appæ´»åŠ¨é¡µå·²é…ç½® | å…¥å£: é¦–é¡µBanner + è®¢å•é¡µæµ®å±‚",
            "POSæŠ˜æ‰£è§„åˆ™å·²ç”Ÿæ•ˆ | è‡ªåŠ¨è¯†åˆ«æ»¡å‡æ¡ä»¶",
            "ä¼šå‘˜ç§¯åˆ†: æ´»åŠ¨æœŸé—´åŒå€ç§¯åˆ† | å·²åŒæ­¥CRM",
            "é¢„æµ‹æ•ˆæœ: è®¢å•+15% | ROI: 2.3 | å»ºè®®æ‰§è¡Œ",
            "ç›‘æ§å‘Šè­¦å·²è®¾ç½® | é¢„ç®—æ¶ˆè€—>80%æ—¶é€šçŸ¥",
        ],
        "store-audit": [
            "è¿è¥æ•°æ®è·å–å®Œæˆ | é—¨åº—: SH-0127 | æ—¶é—´èŒƒå›´: è¿‘7å¤©",
            "äº¤æ˜“åˆ†æ: æ­£å¸¸ | æœªå‘ç°å¼‚å¸¸é€€å•/æŠ˜æ‰£æ¨¡å¼",
            "åº“å­˜å·®å¼‚: 2.1% (æ ‡å‡†<3%) | é¸¡è…¿è‚‰ç›˜äº0.5kg",
            "åŸ¹è®­å®Œæˆåº¦: 94% | å¾…å®Œæˆ: æ–°å‘˜å·¥é£Ÿå“å®‰å…¨(2äºº)",
            "é¡¾å®¢è¯„ä»·: 4.6/5.0 | å…³é”®è¯: é€Ÿåº¦å¿«ã€æœåŠ¡å¥½",
            "åˆè§„è¯„åˆ†: 92/100 | ç­‰çº§: A",
            "æ•´æ”¹æ¸…å•: 2é¡¹ | â‘ è¡¥å®ŒåŸ¹è®­ â‘¡ä¼˜åŒ–å¤‡è´§è®¡åˆ’",
            "å·²æ¨é€è‡³é—¨åº—ç»ç†App | æ•´æ”¹æœŸé™: 7å¤©",
        ],
        "report-gen": [
            "æŠ¥å‘Šç±»å‹: å‘¨æŠ¥ | æ—¶é—´: 2024-W52 | åŒºåŸŸ: åä¸œ",
            "é”€å”®æ•°æ®: äº¤æ˜“Â¥45.2M | è®¢å•612K | å®¢å•ä»·Â¥73.8",
            "çº¿ä¸Šè®¢å•: Â¥18.1M (å æ¯”40%) | å¤–å–Â¥12.3M | è‡ªæÂ¥5.8M",
            "ä¼šå‘˜æ¶ˆè´¹: æ´»è·ƒä¼šå‘˜89K | ä¼šå‘˜è´¡çŒ®62% | å¤è´­ç‡34%",
            "åº“å­˜å‘¨è½¬: å¹³å‡5.2å¤© | æŸè€—ç‡1.8% | è¾ƒä¸Šå‘¨-0.2%",
            "æ ¸å¿ƒKPI: GMV+8% | å®¢æµ+5% | æ»¡æ„åº¦4.7",
            "å›¾è¡¨ç”Ÿæˆ: è¶‹åŠ¿å›¾ã€å¯¹æ¯”å›¾ã€çƒ­åŠ›å›¾å„1å¼ ",
            "æ´å¯Ÿæ‘˜è¦: æœ¬å‘¨å—å¯’æ½®å½±å“çƒ­é¥®é”€é‡+23%ï¼Œå»ºè®®åŠ å¤§å¤‡è´§",
            "æŠ¥å‘Šå·²è¾“å‡º: weekly_report_2024W52.pdf",
        ],
    }

    # å„æŠ€èƒ½çš„æœ€ç»ˆç»“æœæ¨¡æ¿
    FINAL_RESULTS = {
        "menu-config": """âœ… èœå•é…ç½®åŒæ­¥å®Œæˆ

ğŸ“‹ å˜æ›´æ‘˜è¦
â€¢ æ“ä½œç±»å‹: æ–°å¢èœå“
â€¢ èœå“åç§°: {item_name}
â€¢ ä»·æ ¼: Â¥22.00
â€¢ åˆ†ç±»: ä¸»é£Ÿ-æ±‰å ¡

ğŸ”„ ç³»ç»ŸåŒæ­¥çŠ¶æ€
â€¢ POSç³»ç»Ÿ: âœ“ å·²æ›´æ–° (2,847é—¨åº—)
â€¢ Appåå°: âœ“ å·²ä¸Šçº¿
â€¢ èœå•å±: âœ“ å·²æ¨é€ (99.8%æˆåŠŸ)
â€¢ åº“å­˜ç³»ç»Ÿ: âœ“ SKUå·²å…³è”

â±ï¸ ä¸‹ä¸€æ­¥æ“ä½œ
â€¢ ç­‰å¾…åŒºåŸŸç»ç†ç¡®è®¤
â€¢ ç›‘æ§é¦–æ—¥é”€å”®æ•°æ®
â€¢ æ”¶é›†é¡¾å®¢åé¦ˆ

ğŸ”” å·²é€šçŸ¥: è¿è¥ç»„ã€åŒºåŸŸç»ç†ã€å¸‚åœºéƒ¨""",

        "price-adjust": """âœ… åŒºåŸŸä»·æ ¼è°ƒæ•´å·²æäº¤å®¡æ‰¹

ğŸ“Š è°ƒä»·æ‘˜è¦
â€¢ äº§å“: {item_name}
â€¢ åŒºåŸŸ: åä¸œåœ°åŒº
â€¢ åŸä»·: Â¥22.00 â†’ æ–°ä»·: Â¥23.80 (+8.2%)
â€¢ å½±å“é—¨åº—: 1,234å®¶

ğŸ“ˆ å½±å“é¢„ä¼°
â€¢ é¢„è®¡æœˆæ”¶å…¥å˜åŒ–: +Â¥2.3M
â€¢ ä»·æ ¼å¼¹æ€§ç³»æ•°: -0.42
â€¢ ç«å“ä»·æ ¼åŒºé—´: Â¥21-26

â³ å®¡æ‰¹çŠ¶æ€: å¾…åŒºåŸŸæ€»ç›‘å®¡æ‰¹
â€¢ å®¡æ‰¹é“¾: åŒºåŸŸæ€»ç›‘ â†’ è´¢åŠ¡æ€»ç›‘ â†’ CFO
â€¢ é¢„è®¡å®Œæˆ: 24å°æ—¶å†…

âš ï¸ éœ€äººå·¥ç¡®è®¤åç”Ÿæ•ˆ""",

        "product-launch": """âœ… æ–°å“ä¸Šå¸‚åè°ƒå·²å®Œæˆ

ğŸ¯ ä¸Šå¸‚ä¿¡æ¯
â€¢ äº§å“: {item_name}
â€¢ ä¸Šå¸‚æ—¥æœŸ: 2025-01-15
â€¢ é¦–å‘åŒºåŸŸ: å…¨å›½ 2,847å®¶é—¨åº—

ğŸ“¦ å‡†å¤‡è¿›åº¦ (15/18)
âœ“ äº§å“é…æ–¹ç¡®è®¤
âœ“ æˆæœ¬æ ¸ç®—å®Œæˆ
âœ“ SKU/BOMåˆ›å»º
âœ“ POSé…ç½®å®Œæˆ
âœ“ Appå•†å“ä¸Šçº¿
âœ“ èœå•å±ç´ æå°±ç»ª
â³ åŸ¹è®­SOPåˆ¶ä½œä¸­
â³ ç‰©æ–™é…é€ä¸­
â³ æµ‹è¯•è®¢å•éªŒè¯

ğŸ’° è¥é”€æ”¯æŒ
â€¢ é¦–å‘¨ä¼˜æƒ : ç«‹å‡Â¥5
â€¢ æ–°å“åˆ¸å‘æ”¾: 10ä¸‡å¼ 
â€¢ æ¨å¹¿é¢„ç®—: Â¥500K

ğŸ“… å€’è®¡æ—¶: 18å¤©""",

        "campaign-setup": """âœ… è¥é”€æ´»åŠ¨é…ç½®å®Œæˆ

ğŸ‰ æ´»åŠ¨ä¿¡æ¯
â€¢ æ´»åŠ¨åç§°: æ–°å¹´æ»¡å‡ç‹‚æ¬¢
â€¢ æ´»åŠ¨è§„åˆ™: æ»¡30å‡5
â€¢ æ´»åŠ¨æ—¶é—´: 2024.12.28 - 2025.01.03
â€¢ æ´»åŠ¨æ¸ é“: å ‚é£Ÿã€å¤–å–ã€è‡ªæå…¨æ¸ é“

ğŸ”§ ç³»ç»Ÿé…ç½®çŠ¶æ€
â€¢ è¥é”€å¹³å°: âœ“ æ¨¡æ¿å·²åˆ›å»º
â€¢ Appå…¥å£: âœ“ Bannerå·²ä¸Šçº¿
â€¢ POSè§„åˆ™: âœ“ å·²ç”Ÿæ•ˆ
â€¢ ä¼šå‘˜ç³»ç»Ÿ: âœ“ åŒå€ç§¯åˆ†å·²å¯ç”¨

ğŸ“Š é¢„æœŸæ•ˆæœ
â€¢ è®¢å•é‡æå‡: +15%
â€¢ é¢„è®¡ROI: 2.3
â€¢ é¢„ç®—ä½¿ç”¨: Â¥200K

ğŸš¨ ç›‘æ§å·²å¯ç”¨
â€¢ é¢„ç®—æ¶ˆè€—>80%è‡ªåŠ¨é€šçŸ¥
â€¢ å¼‚å¸¸è®¢å•è‡ªåŠ¨æ ‡è®°""",

        "store-audit": """âœ… é—¨åº—å·¡æ£€æŠ¥å‘Šå·²ç”Ÿæˆ

ğŸª é—¨åº—ä¿¡æ¯
â€¢ é—¨åº—ç¼–å·: SH-0127
â€¢ é—¨åº—åç§°: ä¸Šæµ·å—äº¬è·¯åº—
â€¢ æ£€æŸ¥æ—¶é—´: 2024-12-28

ğŸ“Š ç»¼åˆè¯„åˆ†: 92/100 (Açº§)

âœ“ é£Ÿå“å®‰å…¨: 95åˆ†
âœ“ æœåŠ¡æ ‡å‡†: 90åˆ†
âœ“ è®¾å¤‡ç»´æŠ¤: 93åˆ†
âš ï¸ å‘˜å·¥åŸ¹è®­: 88åˆ†
âœ“ è´¢åŠ¡åˆè§„: 94åˆ†

ğŸ“‹ æ•´æ”¹äº‹é¡¹ (2é¡¹)
1. æ–°å‘˜å·¥é£Ÿå“å®‰å…¨åŸ¹è®­å¾…å®Œæˆ (2äºº)
2. ä¼˜åŒ–æ—©é¤æ—¶æ®µå¤‡è´§è®¡åˆ’

â° æ•´æ”¹æœŸé™: 2025-01-04
ğŸ“± å·²æ¨é€è‡³é—¨åº—ç»ç†App""",

        "report-gen": """âœ… è¿è¥å‘¨æŠ¥å·²ç”Ÿæˆ

ğŸ“… æŠ¥å‘Šå‘¨æœŸ: 2024å¹´ç¬¬52å‘¨
ğŸ“ æŠ¥å‘ŠåŒºåŸŸ: åä¸œåœ°åŒº

ğŸ“ˆ æ ¸å¿ƒæŒ‡æ ‡
â€¢ æ€»äº¤æ˜“é¢: Â¥45.2M (+8% ç¯æ¯”)
â€¢ è®¢å•é‡: 612K (+5% ç¯æ¯”)
â€¢ å®¢å•ä»·: Â¥73.8 (+3% ç¯æ¯”)
â€¢ é¡¾å®¢æ»¡æ„åº¦: 4.7/5.0

ğŸ›’ æ¸ é“åˆ†å¸ƒ
â€¢ å ‚é£Ÿ: Â¥27.1M (60%)
â€¢ å¤–å–: Â¥12.3M (27%)
â€¢ è‡ªæ: Â¥5.8M (13%)

ğŸ‘¥ ä¼šå‘˜æ´å¯Ÿ
â€¢ æ´»è·ƒä¼šå‘˜: 89K
â€¢ ä¼šå‘˜æ¶ˆè´¹å æ¯”: 62%
â€¢ å¤è´­ç‡: 34%

ğŸ’¡ æœ¬å‘¨æ´å¯Ÿ
å—å¯’æ½®å¤©æ°”å½±å“ï¼Œçƒ­é¥®å“ç±»é”€é‡å¤§æ¶¨23%ï¼Œ
å»ºè®®ä¸‹å‘¨ç»§ç»­åŠ å¤§çƒ­é¥®å¤‡è´§ï¼ŒæŠŠæ¡å¤©æ°”çº¢åˆ©ã€‚

ğŸ“„ æŠ¥å‘Šå·²å¯¼å‡º: weekly_report_2024W52.pdf""",
    }

    def simulate_operations(
        self, skill_name: str, step_idx: int, affected_systems: list[str]
    ) -> list[SystemOperation]:
        """æ¨¡æ‹Ÿå¯¹å„ä¸ªåç«¯ç³»ç»Ÿçš„æ“ä½œ"""
        operations = []
        actions = self.SYSTEM_ACTIONS.get(skill_name, {}).get(step_idx, [])

        for system, action in actions:
            if system in affected_systems or not affected_systems:
                op = SystemOperation(
                    system=self.SYSTEMS.get(system, {}).get("name", system),
                    operation=action,
                    status=SkillStatus.RUNNING,
                )
                operations.append(op)

        return operations

    def get_step_result(
        self, skill_name: str, step_idx: int, args: Optional[str] = None
    ) -> str:
        """è·å–æ­¥éª¤æ‰§è¡Œç»“æœ"""
        item_name = args or "éº¦è¾£é¸¡è…¿å ¡"
        skill_results = self.STEP_RESULTS.get(skill_name, [])

        if step_idx < len(skill_results):
            return skill_results[step_idx].format(item_name=item_name)
        return f"æ­¥éª¤ {step_idx + 1} æ‰§è¡Œå®Œæˆ"

    def get_final_result(self, skill_name: str, args: Optional[str] = None) -> str:
        """ç”Ÿæˆæœ€ç»ˆæ‰§è¡Œç»“æœ"""
        item_name = args or "éº¦è¾£é¸¡è…¿å ¡"
        template = self.FINAL_RESULTS.get(skill_name)

        if template:
            return template.format(item_name=item_name)
        return f"âœ… {skill_name} æ‰§è¡Œå®Œæˆ"

    def get_system_info(self, system_key: str) -> dict:
        """è·å–ç³»ç»Ÿä¿¡æ¯"""
        return self.SYSTEMS.get(system_key, {"name": system_key, "color": "#6b7280"})
